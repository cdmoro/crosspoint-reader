<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CrossPoint Reader - Files</title>
  </head>
  <body>
    <h1>
      <span class="logo">
        <svg
          width="18"
          height="18"
          viewBox="0 0 162 180"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M141.133 1.93774C150.102 -3.44192 161.517 3.01665 161.521 13.4749V166.526C161.517 176.984 150.102 183.442 141.133 178.063L80.7588 141.837L20.3867 178.063C11.4176 183.442 0.00328866 176.984 0 166.526V13.4749C0.00337257 3.01685 11.4176 -3.44137 20.3867 1.93774L80.7598 38.1614L141.133 1.93774ZM121.275 117.524L92.3848 134.864L147.281 167.811C148.277 168.408 149.542 167.685 149.545 166.526V100.567L121.275 117.524ZM14.2393 12.1897C13.2438 11.5924 11.979 12.3152 11.9756 13.4749V86.6125L74.7725 124.29V48.51L14.2393 12.1897Z"
            fill="black"
          />
        </svg>
      </span>
      CrossPoint Reader
    </h1>
    <div class="nav-links">
      <a href="/">Home</a>
      <a href="/files" class="active">File Manager</a>
      <a href="/settings">Settings</a>
    </div>

    <div class="page-header">
      <div class="page-header-left">
        <h2>File Manager</h2>
      </div>

      <div class="action-buttons">
        <button class="btn btn-primary action-btn upload-action-btn">
          <svg class="icon" aria-hidden="true">
            <use width="16" height="16" href="#icon-upload"></use>
          </svg>
          Upload file
        </button>
        <button class="btn btn-secondary action-btn folder-action-btn">
          <svg class="icon" aria-hidden="true">
            <use width="16" height="16" href="#icon-folder"></use>
          </svg>
          New Folder
        </button>
      </div>
    </div>

    <div class="breadcrumb-inline" id="directory-breadcrumbs"></div>

    <!-- Failed Uploads Banner -->
    <div
      class="alert alert-warning failed-uploads-banner"
      id="failedUploadsBanner"
    >
      <div class="failed-uploads-header">
        <h3 class="failed-uploads-title">
          <svg class="icon" aria-hidden="true">
            <use href="#icon-warning"></use>
          </svg>
          Some files failed to upload
        </h3>
        <button
          class="dismiss-btn"
          onclick="dismissFailedUploads()"
          title="Dismiss"
        >
          &times;
        </button>
      </div>
      <div id="failedFilesList"></div>
      <button
        class="btn btn-warning btn-sm retry-all-btn"
        onclick="retryAllFailedUploads()"
      >
        Retry All Failed Uploads
      </button>
    </div>

    <div class="card contents-card">
      <div class="contents-header">
        <h3>Contents</h3>
        <span class="summary-inline" id="folder-summary"></span>
      </div>

      <div id="file-table">
        <div class="loader-container">
          <span class="loader"></span>
        </div>
      </div>
    </div>

    <footer>
      <a
        href="https://github.com/crosspoint-reader/crosspoint-reader"
        target="_blank"
        >CrossPoint E-Reader â€¢ Open Source</a
      >
    </footer>

    <!-- Upload Modal -->
    <dialog id="uploadModal">
      <div class="modal-header">
        <h3>
          <svg class="icon" aria-hidden="true">
            <use href="#icon-upload"></use>
          </svg>
          Upload file
        </h3>
        <button class="modal-close" onclick="uploadModal.close()">
          &times;
        </button>
      </div>
      <div class="upload-form">
        <p class="file-info">
          Select a file to upload to <strong id="uploadPathDisplay"></strong>
        </p>
        <form id="uploadForm">
          <input
            type="file"
            id="fileInput"
            multiple
            required
          />
          <div id="progress-container">
            <div id="progress-bar"><div id="progress-fill"></div></div>
            <div id="progress-text"></div>
          </div>
          <div class="modal-footer">
            <button
              id="uploadBtn"
              class="btn btn-primary upload-btn"
              type="submit"
            >
              Upload
            </button>
          </div>
        </form>
      </div>
    </dialog>

    <!-- New Folder Modal -->
    <dialog id="folderModal">
      <div class="modal-header">
        <h3>
          <svg class="icon" aria-hidden="true">
            <use href="#icon-folder"></use>
          </svg>
          New Folder
        </h3>
        <button class="modal-close" onclick="folderModal.close()">
          &times;
        </button>
      </div>
      <div class="folder-form">
        <p class="file-info">
          Create a new folder in <strong id="folderPathDisplay"></strong>
        </p>
        <form id="create-folder-form">
          <input
            type="text"
            id="folderName"
            class="folder-input"
            placeholder="Folder name..."
            required
          />
          <div class="modal-footer">
            <button class="btn btn-primary folder-btn" type="submit">
              Create Folder
            </button>
          </div>
        </form>
      </div>
    </dialog>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" id="deleteModal">
      <div class="modal">
        <button class="modal-close" onclick="closeDeleteModal()">
          &times;
        </button>
        <h3>
          <svg class="icon" aria-hidden="true">
            <use href="#icon-trash"></use>
          </svg>
          Delete Item
        </h3>
        <div class="folder-form">
          <div class="alert alert-danger alert-icon">
            <svg class="icon icon-warning" aria-hidden="true">
              <use href="#icon-warning"></use>
            </svg>
            This action cannot be undone!
          </div>
          <p class="file-info">Are you sure you want to delete:</p>
          <p class="delete-item-name" id="deleteItemName"></p>
          <form id="delete-form">
            
            <input type="hidden" id="deleteItemPath" />
            <input type="hidden" id="deleteItemType" />
            <div class="modal-footer">
              <button
                class="btn btn-secondary delete-btn-cancel"
                onclick="closeDeleteModal()"
              >
                Cancel
              </button>
              <button
                class="btn btn-danger delete-btn-confirm"
                type="submit"
              >
                Delete
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Rename Modal -->
    <div class="modal-overlay" id="renameModal">
      <div class="modal">
        <div class="modal-header">
          <h3>
            <svg class="icon" aria-hidden="true">
              <use href="#icon-edit"></use>
            </svg>
            Rename File
          </h3>
          <button class="modal-close" onclick="closeRenameModal()">
            &times;
          </button>
        </div>
        <div class="folder-form">
          <p>
            Renaming <span id="renameItemName" class="file-name-badge"></span>
          </p>
          <form id="rename-form">
            <input
              type="text"
              id="renameNewName"
              class="folder-input"
              placeholder="New file name..."
            />
            <input type="hidden" id="renameItemPath" />
            <div class="modal-footer">
              <button
                class="btn btn-secondary delete-btn-cancel"
                onclick="closeRenameModal()"
              >
                Cancel
              </button>
              <button
                class="btn btn-primary rename-btn-confirm"
                type="submit"
              >
                Rename
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Move Modal -->
    <div class="modal-overlay" id="moveModal">
      <div class="modal">
        <div class="modal-header">
          <h3>
            <svg class="icon" aria-hidden="true">
              <use href="#icon-move-file"></use>
            </svg>
            Move File
          </h3>
          <button class="modal-close" onclick="closeMoveModal()">
            &times;
          </button>
        </div>
        <div class="folder-form">
          <p>Moving <span id="moveItemName" class="file-name-badge"></span></p>
          <form id="move-form">
            <input
              type="text"
              id="moveDestPath"
              class="folder-input"
              list="moveFolderOptions"
              placeholder="/Destination/Folder"
            />
            <datalist id="moveFolderOptions"></datalist>
            <input type="hidden" id="moveItemPath" />
            <div class="modal-footer">
              <button
                class="btn btn-secondary delete-btn-cancel"
                onclick="closeMoveModal()"
              >
                Cancel
              </button>
              <button
                class="btn btn-primary move-btn-confirm"
                onclick="confirmMove()"
              >
                Move
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <svg xmlns="http://www.w3.org/2000/svg" style="display: none">
      <symbol viewBox="260 205 27 32" id="icon-trash">
        <path
          fill="currentColor"
          d="M268,220 C268,219.448 268.448,219 269,219 C269.552,219 270,219.448 270,220 L270,232 C270,232.553 269.552,233 269,233 C268.448,233 268,232.553 268,232 L268,220 L268,220 Z M273,220 C273,219.448 273.448,219 274,219 C274.552,219 275,219.448 275,220 L275,232 C275,232.553 274.552,233 274,233 C273.448,233 273,232.553 273,232 L273,220 L273,220 Z M278,220 C278,219.448 278.448,219 279,219 C279.552,219 280,219.448 280,220 L280,232 C280,232.553 279.552,233 279,233 C278.448,233 278,232.553 278,232 L278,220 L278,220 Z M263,233 C263,235.209 264.791,237 267,237 L281,237 C283.209,237 285,235.209 285,233 L285,217 L263,217 L263,233 L263,233 Z M277,209 L271,209 L271,208 C271,207.447 271.448,207 272,207 L276,207 C276.552,207 277,207.447 277,208 L277,209 L277,209 Z M285,209 L279,209 L279,207 C279,205.896 278.104,205 277,205 L271,205 C269.896,205 269,205.896 269,207 L269,209 L263,209 C261.896,209 261,209.896 261,211 L261,213 C261,214.104 261.895,214.999 262.999,215 L285.002,215 C286.105,214.999 287,214.104 287,213 L287,211 C287,209.896 286.104,209 285,209 L285,209 Z"
        ></path>
      </symbol>

      <symbol viewBox="0 0 24 24" id="icon-edit">
        <path
          fill="currentColor"
          d="M12 21C12 20.4477 12.4477 20 13 20H21C21.5523 20 22 20.4477 22 21C22 21.5523 21.5523 22 21 22H13C12.4477 22 12 21.5523 12 21Z"
        ></path>
        <path
          fill="currentColor"
          d="M20.7736 8.09994C22.3834 6.48381 22.315 4.36152 21.113 3.06183C20.5268 2.4281 19.6926 2.0233 18.7477 2.00098C17.7993 1.97858 16.8167 2.34127 15.91 3.09985C15.8868 3.11925 15.8645 3.13969 15.8432 3.16111L2.87446 16.1816C2.31443 16.7438 2 17.5051 2 18.2987V19.9922C2 21.0937 2.89197 22 4.00383 22H5.68265C6.48037 22 7.24524 21.6823 7.80819 21.1171L20.7736 8.09994ZM17.2071 5.79295C16.8166 5.40243 16.1834 5.40243 15.7929 5.79295C15.4024 6.18348 15.4024 6.81664 15.7929 7.20717L16.7929 8.20717C17.1834 8.59769 17.8166 8.59769 18.2071 8.20717C18.5976 7.81664 18.5976 7.18348 18.2071 6.79295L17.2071 5.79295Z"
        ></path>
      </symbol>

      <symbol viewBox="0 0 24 24" id="icon-folder">
        <path
          fill="currentColor"
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M1 5C1 3.34315 2.34315 2 4 2H8.55848C9.84977 2 10.9962 2.82629 11.4045 4.05132L11.7208 5H20C21.1046 5 22 5.89543 22 7V9.00961C23.1475 9.12163 23.9808 10.196 23.7695 11.3578L22.1332 20.3578C21.9603 21.3087 21.132 22 20.1654 22H3C1.89543 22 1 21.1046 1 20V5ZM20 9V7H11.7208C10.8599 7 10.0956 6.44914 9.82339 5.63246L9.50716 4.68377C9.37105 4.27543 8.98891 4 8.55848 4H4C3.44772 4 3 4.44772 3 5V12.2709L3.35429 10.588C3.54913 9.66249 4.36562 9 5.31139 9H20ZM3.36634 20C3.41777 19.9109 3.4562 19.8122 3.47855 19.706L5.31139 11L21 11H21.8018L20.1654 20L3.36634 20Z"
        ></path>
      </symbol>

      <symbol viewBox="-10 -5 1034 1034" id="icon-epub">
        <path
          fill="currentColor"
          d="M500 227q-19 0 -32 13l-355 354q-13 14 -13 33t13 32l355 354q13 14 32 14t32 -14l355 -354q13 -13 13 -32t-13 -33l-52 -51l-335 335l-251 -251l251 -252l84 84l-168 168l84 83l251 -251l-219 -219q-13 -13 -32 -13z"
        ></path>
      </symbol>

      <symbol viewBox="0 0 24 24" id="icon-file">
        <path
          fill="transparent"
          d="M9 17H15M9 13H15M9 9H10M13 3H8.2C7.0799 3 6.51984 3 6.09202 3.21799C5.71569 3.40973 5.40973 3.71569 5.21799 4.09202C5 4.51984 5 5.0799 5 6.2V17.8C5 18.9201 5 19.4802 5.21799 19.908C5.40973 20.2843 5.71569 20.5903 6.09202 20.782C6.51984 21 7.0799 21 8.2 21H15.8C16.9201 21 17.4802 21 17.908 20.782C18.2843 20.5903 18.5903 20.2843 18.782 19.908C19 19.4802 19 18.9201 19 17.8V9M13 3L19 9M13 3V7.4C13 7.96005 13 8.24008 13.109 8.45399C13.2049 8.64215 13.3578 8.79513 13.546 8.89101C13.7599 9 14.0399 9 14.6 9H19"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
      </symbol>

      <symbol viewBox="0 0 24 24" id="icon-move-file">
        <path
          fill="transparent"
          d="M15 17H21M21 17L19 19M21 17L19 15M13 3H8.2C7.0799 3 6.51984 3 6.09202 3.21799C5.71569 3.40973 5.40973 3.71569 5.21799 4.09202C5 4.51984 5 5.0799 5 6.2V17.8C5 18.9201 5 19.4802 5.21799 19.908C5.40973 20.2843 5.71569 20.5903 6.09202 20.782C6.51984 21 7.0799 21 8.2 21H15M13 3L19 9M13 3V7.4C13 7.96005 13 8.24008 13.109 8.45399C13.2049 8.64215 13.3578 8.79513 13.546 8.89101C13.7599 9 14.0399 9 14.6 9H19M19 9V11.0228"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
      </symbol>

      <symbol viewBox="0 0 24 24" id="icon-upload">
        <path
          fill="transparent"
          d="M17 17H17.01M15.6 14H18C18.9319 14 19.3978 14 19.7654 14.1522C20.2554 14.3552 20.6448 14.7446 20.8478 15.2346C21 15.6022 21 16.0681 21 17C21 17.9319 21 18.3978 20.8478 18.7654C20.6448 19.2554 20.2554 19.6448 19.7654 19.8478C19.3978 20 18.9319 20 18 20H6C5.06812 20 4.60218 20 4.23463 19.8478C3.74458 19.6448 3.35523 19.2554 3.15224 18.7654C3 18.3978 3 17.9319 3 17C3 16.0681 3 15.6022 3.15224 15.2346C3.35523 14.7446 3.74458 14.3552 4.23463 14.1522C4.60218 14 5.06812 14 6 14H8.4M12 15V4M12 4L15 7M12 4L9 7"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
      </symbol>

      <symbol viewBox="0 0 64 64" id="icon-home">
        <path
          fill="currentColor"
          d="M56.87 25.981L50.27 21.031L47.27 18.781L35.57 10.001C34.4423 9.16327 33.0748 8.71094 31.67 8.71094C30.2652 8.71094 28.8977 9.16327 27.77 10.001L21.67 14.581V14.371C21.6684 13.8411 21.4572 13.3333 21.0825 12.9586C20.7077 12.5838 20.1999 12.3726 19.67 12.371H12.47C11.9396 12.371 11.4309 12.5817 11.0558 12.9568C10.6807 13.3319 10.47 13.8406 10.47 14.371V23.161L6.44002 26.291C6.23227 26.4524 6.05838 26.6531 5.92833 26.8817C5.79827 27.1103 5.71459 27.3624 5.68208 27.6234C5.64957 27.8844 5.66888 28.1493 5.73887 28.4028C5.80887 28.6564 5.92819 28.8936 6.09001 29.101C6.276 29.3427 6.51546 29.538 6.7896 29.6716C7.06373 29.8052 7.36505 29.8734 7.67 29.871C8.11211 29.8709 8.54152 29.7231 8.89 29.451L10.47 28.231V48.281C10.4716 50.0044 11.1569 51.6568 12.3756 52.8755C13.5942 54.0941 15.2466 54.7794 16.97 54.781H25.6C25.9594 54.7808 26.3121 54.6831 26.6203 54.4981C26.9285 54.3132 27.1807 54.0481 27.35 53.731C27.5142 53.4413 27.6003 53.114 27.6 52.781C27.6017 52.7109 27.5983 52.6407 27.59 52.571V46.851C27.5916 45.7703 28.0223 44.7345 28.7874 43.9713C29.5525 43.2081 30.5893 42.7799 31.67 42.781C32.7491 42.7821 33.7837 43.2112 34.5468 43.9742C35.3098 44.7373 35.7389 45.7719 35.74 46.851V52.781C35.7397 53.114 35.8259 53.4413 35.99 53.731C36.1624 54.0477 36.4167 54.3122 36.7263 54.4969C37.0359 54.6816 37.3895 54.7797 37.75 54.781H46.37C48.0929 54.7776 49.7442 54.0917 50.9624 52.8734C52.1807 51.6552 52.8666 50.0039 52.87 48.281V27.981L54.47 29.181C54.8129 29.4398 55.2305 29.5801 55.66 29.581C55.9718 29.5802 56.2792 29.5076 56.5584 29.3689C56.8376 29.2301 57.081 29.029 57.27 28.781C57.5883 28.3567 57.7249 27.8233 57.6499 27.2982C57.5749 26.7731 57.2944 26.2993 56.87 25.981Z"
        ></path>
      </symbol>

      <symbol viewBox="0 0 24 24" id="icon-warning">
        <path
          fill="currentColor"
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M11 13C11 13.5523 11.4477 14 12 14C12.5523 14 13 13.5523 13 13V10C13 9.44772 12.5523 9 12 9C11.4477 9 11 9.44772 11 10V13ZM13 15.9888C13 15.4365 12.5523 14.9888 12 14.9888C11.4477 14.9888 11 15.4365 11 15.9888V16C11 16.5523 11.4477 17 12 17C12.5523 17 13 16.5523 13 16V15.9888ZM9.37735 4.66136C10.5204 2.60393 13.4793 2.60393 14.6223 4.66136L21.2233 16.5431C22.3341 18.5427 20.8882 21 18.6008 21H5.39885C3.11139 21 1.66549 18.5427 2.77637 16.5431L9.37735 4.66136Z"
        ></path>
      </symbol>

      <symbol viewBox="0 0 24 24" id="icon-info">
        <path
          fill="currentColor"
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12ZM12 17.75C12.4142 17.75 12.75 17.4142 12.75 17V11C12.75 10.5858 12.4142 10.25 12 10.25C11.5858 10.25 11.25 10.5858 11.25 11V17C11.25 17.4142 11.5858 17.75 12 17.75ZM12 7C12.5523 7 13 7.44772 13 8C13 8.55228 12.5523 9 12 9C11.4477 9 11 8.55228 11 8C11 7.44772 11.4477 7 12 7Z"
        ></path>
      </symbol>
    </svg>

    <script type="module" src="./src/FilesPage.ts"></script>
  </body>
</html>
